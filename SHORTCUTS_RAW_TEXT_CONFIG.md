# 📱 快捷指令原始文本配置指南

## 🎯 目标

配置 iPhone 快捷指令发送原始文本格式到云端，支持你现有的语音+文本输入模式。

## 📋 你的数据格式

根据你提供的示例，你的文本格式是：
```
日期：2025年8月18日 18:05
【语音输入】
日期：
健身：
学习： 
工作：
灵感：
【文本输入】
心情：不错
健身：没有特别好吃的
学习：没
工作：没
灵感：没
```

## 🔧 快捷指令配置步骤

### 方法1：发送完整原始文本

如果你的快捷指令已经能生成这样的完整文本，只需要：

1. **保持现有的文本生成逻辑不变**
2. **配置"获取 URL 内容"操作**：
   - URL: `https://personal-website-hpkr7fq67-gwen-zs-projects.vercel.app/api/raw-entry`
   - 方法: `POST`
   - 请求体: 构建如下 JSON
   ```json
   {
     "raw_text": "你的完整文本内容"
   }
   ```
   - 头部: `Content-Type: application/json`

### 详细配置步骤

#### 1. 获取你的完整文本
假设你已经有一个变量包含了完整的文本内容（如上面的格式）

#### 2. 构建 JSON 数据
使用"获取字典的值"操作：
- **键**: `raw_text`
- **值**: 选择你的完整文本变量

#### 3. 配置 HTTP 请求
使用"获取 URL 内容"操作：
- **URL**: `https://personal-website-hpkr7fq67-gwen-zs-projects.vercel.app/api/raw-entry`
- **方法**: `POST`
- **请求体**: 选择上一步创建的字典
- **头部**: 添加 `Content-Type: application/json`

### 方法2：重构为分别收集然后组合

如果你想重构快捷指令：

1. **获取当前日期和时间**
   ```
   格式：yyyy年MM月dd日 HH:mm
   ```

2. **收集各项内容**（可以是语音输入或文本输入）
   - 心情描述
   - 健身记录
   - 学习内容
   - 工作记录
   - 灵感想法

3. **组合成文本**
   使用"获取文本"操作，组合格式：
   ```
   日期：[当前日期时间]
   【语音输入】
   日期：
   健身：
   学习：
   工作：
   灵感：
   【文本输入】
   心情：[心情内容]
   健身：[健身内容]
   学习：[学习内容]
   工作：[工作内容]
   灵感：[灵感内容]
   ```

4. **发送到云端**
   按照方法1的步骤配置 HTTP 请求

## 🧠 AI 解析逻辑

云端 API 会自动解析你的文本：

1. **提取日期**: 从"日期：2025年8月18日"中提取并转换为标准格式
2. **优先使用文本输入**: 优先从【文本输入】部分提取内容
3. **语音输入作为备选**: 如果文本输入为空或"没"，则使用【语音输入】部分
4. **智能处理**: 自动过滤"没"等无效内容
5. **AI 分析**: 对有效内容进行情感分析和运动解析

## 📊 处理结果

API 会返回处理结果：
```json
{
  "success": true,
  "message": "Data saved successfully",
  "data": {
    "date": "2025-08-18",
    "mood_summary": {
      "emoji": "😊",
      "event": "心情不错",
      "score": 2,
      "category": "积极"
    },
    "fitness_summary": {
      "intensity": "轻度运动",
      "duration": "",
      "calories": "",
      "type": "运动"
    }
  }
}
```

## 🧪 测试方法

### 1. 手动测试
可以用这个测试文本验证 API：
```bash
curl -X POST https://personal-website-hpkr7fq67-gwen-zs-projects.vercel.app/api/raw-entry \
  -H "Content-Type: application/json" \
  -d '{
    "raw_text": "日期：2025年1月19日\n【语音输入】\n日期：\n健身：\n学习：\n工作：\n灵感：\n【文本输入】\n心情：测试心情不错\n健身：跑步30分钟\n学习：学习了新技术\n工作：完成了项目\n灵感：有个新想法"
  }'
```

### 2. 快捷指令测试
1. 配置好快捷指令后运行一次
2. 输入测试数据
3. 检查是否有成功提示
4. 可访问 API 查看数据：`https://personal-website-hpkr7fq67-gwen-zs-projects.vercel.app/api/simple-records`

## ⚠️ 注意事项

1. **网络连接**: 确保 iPhone 有稳定的网络连接
2. **文本编码**: 确保中文字符正确传输
3. **错误处理**: 在快捷指令中添加错误处理逻辑
4. **数据备份**: 重要数据建议本地也保存一份

## 🔄 兼容性

这个配置同时支持：
- ✅ 原始文本格式（你现在的方式）
- ✅ 结构化字段格式（之前的方式）
- ✅ 中文日期格式（2025年8月18日）
- ✅ 标准日期格式（2025-08-18）

## 📞 故障排除

### 连接失败
- 检查 URL 是否正确
- 确认网络连接
- 验证请求格式

### 数据解析失败
- 检查文本格式是否包含必要的标识符
- 确认日期格式正确
- 验证【文本输入】和【语音输入】标记存在

### 身份验证错误
- 如遇到 401 错误，可能需要在 Vercel 控制台禁用身份验证保护
- 或联系管理员配置公开访问权限
