# 📱 iPhone 快捷指令云端配置指南

## 🎯 目标更新

将快捷指令从"本地 Mac 依赖"改为"云端 Vercel 收集"，实现：
- ✅ 无需 Mac 开机即可传输数据
- ✅ 随时随地记录个人数据
- ✅ 自动云端存储和处理

## 🔧 更新步骤

### 1. 修改快捷指令 URL

将原来的本地地址：
```
http://192.168.31.23:3001/api/raw-entry
```

更改为你的 Vercel 云端地址：
```
https://your-app.vercel.app/api/raw-entry
```

### 2. 调整数据格式

**新的数据格式**（文本描述而非数字评分）：

```json
{
  "date": "2024-01-15",
  "mood_text": "今天心情不错，工作很顺利",
  "life_text": "跑步30分钟，消耗了300卡路里",
  "study_text": "学习了TypeScript和Vercel部署",
  "work_text": "完成了API开发和数据库配置",
  "inspiration_text": "想到了一个新的项目想法"
}
```

### 3. 更新快捷指令操作

#### 3.1 保持日期获取不变
- "获取当前日期" → 格式：`yyyy-MM-dd`

#### 3.2 修改用户输入（改为文本）
将原来的数字输入改为文本描述：

1. **心情文本输入**
   - 操作：要求输入 → **文本**
   - 提示：描述一下今天的心情
   - 变量名：moodText

2. **生活/健身文本输入**
   - 操作：要求输入 → **文本**
   - 提示：记录今天的运动或生活状态
   - 变量名：lifeText

3. **学习文本输入**
   - 操作：要求输入 → **文本**
   - 提示：今天学了什么新知识？
   - 变量名：studyText

4. **工作文本输入**
   - 操作：要求输入 → **文本**
   - 提示：记录今天的工作内容
   - 变量名：workText

5. **灵感文本输入**
   - 操作：要求输入 → **文本**
   - 提示：有什么新想法或灵感吗？
   - 变量名：inspirationText

#### 3.3 构建新的 JSON 数据
在"获取字典的值"操作中设置：

```json
{
  "date": "当前日期",
  "mood_text": "moodText",
  "life_text": "lifeText",
  "study_text": "studyText", 
  "work_text": "workText",
  "inspiration_text": "inspirationText"
}
```

#### 3.4 更新 HTTP 请求
- **URL**: `https://your-app.vercel.app/api/raw-entry`
- **方法**: POST
- **请求体**: 选择上一步的字典
- **头部**: 
  - Content-Type: application/json

## 🌟 优势对比

### 之前（本地方案）
- ❌ 需要 Mac 开机并运行后端
- ❌ 需要在同一 WiFi 网络
- ❌ Mac 关机时无法记录数据
- ❌ 需要配置 SSH 或本地 HTTP 服务

### 现在（云端方案）
- ✅ 24/7 可用，无需 Mac 开机
- ✅ 支持任何网络环境（4G/5G/WiFi）
- ✅ 自动云端存储和备份
- ✅ AI 自动分析和标签化
- ✅ 支持文本描述，更自然

## 📊 数据处理说明

### 云端 AI 自动处理
系统会自动从你的文本描述中提取：

**心情分析**：
- 情绪倾向：积极/中性/消极
- 心情评分：-3 到 +3
- 自动表情符号：😊😐😔
- 关键事件提取

**健身分析**：
- 运动类型：跑步/游泳/健身房/瑜伽等
- 运动强度：高强度/中等强度/轻度运动
- 持续时间：自动提取分钟数
- 卡路里消耗：自动提取数值

## 🧪 测试方法

### 1. 快速测试
完成配置后，运行一次快捷指令，输入测试数据：
- 心情：今天很开心
- 生活：散步20分钟
- 学习：看了一篇技术文章
- 工作：开了个会议
- 灵感：想到改进工作流程的方法

### 2. 验证数据
访问 `https://your-app.vercel.app/api/simple-records` 查看是否有数据。

### 3. 查看处理结果
访问 `https://your-app.vercel.app/api/dashboard` 查看 AI 处理后的结果。

## 🔍 故障排除

### 1. 连接失败
- 检查 Vercel 应用是否部署成功
- 确认 URL 地址正确
- 检查网络连接

### 2. 数据格式错误
- 确保所有字段都是文本类型
- 检查 JSON 格式是否正确

### 3. 环境变量未配置
- 在 Vercel 控制台检查 TURSO_DATABASE_URL 和 TURSO_AUTH_TOKEN
- 重新部署项目以确保环境变量生效

## 📈 后续扩展

配置完成后，还可以：
- 添加语音输入支持
- 集成 Siri 快捷指令
- 设置定时提醒
- 添加地理位置记录
- 集成健康数据同步
