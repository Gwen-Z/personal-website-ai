# 部署指南

## 问题分析

你遇到的问题主要有以下几个：

1. **数据结构不匹配**：后端返回的数据结构与前端期望的不一致
2. **API地址配置错误**：前端默认指向localhost:5000，但后端运行在5001端口
3. **Vercel环境变量未配置**：部署到Vercel时没有正确配置API地址

## 解决方案

### 1. 前端修复 ✅

已经修复了前端代码，现在可以正确处理后端返回的数据结构。

### 2. 后端数据库修复 ✅

已经修复了数据库字段类型，将TEXT改为REAL以正确存储数值。

### 3. Vercel部署配置

#### 前端部署

1. 在Vercel项目设置中添加环境变量：
   ```
   REACT_APP_API_URL=https://your-backend-domain.vercel.app
   ```

2. 确保环境变量指向正确的后端API地址

#### 后端部署

1. 将后端代码部署到Vercel或其他平台
2. 更新前端环境变量指向新的后端地址

### 4. 本地测试

在部署到Vercel之前，建议先在本地测试：

1. 启动后端：
   ```bash
   cd backend
   npm install
   node app.js
   ```

2. 启动前端：
   ```bash
   cd frontend
   npm install
   npm start
   ```

3. 测试数据添加和显示是否正常

### 5. 常见问题排查

1. **检查浏览器控制台**：
   - 打开开发者工具
   - 查看Console和Network标签页
   - 检查是否有API请求错误

2. **验证API响应**：
   - 直接访问 `https://your-backend-domain.vercel.app/api/records`
   - 确认返回的数据格式正确

3. **环境变量检查**：
   - 在Vercel项目设置中确认环境变量已正确设置
   - 重新部署以确保环境变量生效

### 6. 数据迁移

如果现有数据库中的数据是TEXT格式，需要迁移：

1. 备份现有数据
2. 删除数据库文件
3. 重新启动后端，创建新的数据库结构
4. 重新添加数据

## 验证步骤

1. 本地测试：确保本地环境正常工作
2. 后端部署：将后端部署到Vercel
3. 前端部署：更新环境变量并部署前端
4. 功能测试：验证数据添加和显示功能 